(function(){"use strict";var e={7861:function(e,t,n){var o=n(5130),i=n(6768),a=n(4232);const r={id:"app"},l={key:0},u={key:1};function c(e,t,n,o,c,s){const p=(0,i.g2)("AppointmentForm");return(0,i.uX)(),(0,i.CE)("div",r,[t[3]||(t[3]=(0,i.Lk)("h1",null,"Appointment Scheduler",-1)),o.isAuthenticated?((0,i.uX)(),(0,i.CE)("div",u,[(0,i.Lk)("p",null,"Welcome, "+(0,a.v_)(o.userName),1),(0,i.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>o.logout&&o.logout(...e))},"Logout"),(0,i.bF)(p,{isAuthenticated:o.isAuthenticated},null,8,["isAuthenticated"])])):((0,i.uX)(),(0,i.CE)("div",l,[t[2]||(t[2]=(0,i.Lk)("p",null,"Not authenticated yet. Please login.",-1)),(0,i.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>o.login&&o.login(...e))},"Login with Microsoft")]))])}n(4603),n(7566),n(8721);var s=n(144);const p={key:1},d={key:2};function f(e,t,n,r,l,u){return(0,i.uX)(),(0,i.CE)("div",null,[t[10]||(t[10]=(0,i.Lk)("h2",null,"Schedule an Appointment",-1)),n.isAuthenticated?((0,i.uX)(),(0,i.CE)("form",{key:0,onSubmit:t[4]||(t[4]=(0,o.D$)(((...e)=>r.createAppointment&&r.createAppointment(...e)),["prevent"]))},[(0,i.Lk)("div",null,[t[5]||(t[5]=(0,i.Lk)("label",{for:"title"},"Title:",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>r.title=e),required:""},null,512),[[o.Jo,r.title]])]),(0,i.Lk)("div",null,[t[6]||(t[6]=(0,i.Lk)("label",{for:"startTime"},"Start Time:",-1)),(0,i.bo)((0,i.Lk)("input",{type:"datetime-local",id:"startTime","onUpdate:modelValue":t[1]||(t[1]=e=>r.startTime=e),required:""},null,512),[[o.Jo,r.startTime]])]),(0,i.Lk)("div",null,[t[7]||(t[7]=(0,i.Lk)("label",{for:"endTime"},"End Time:",-1)),(0,i.bo)((0,i.Lk)("input",{type:"datetime-local",id:"endTime","onUpdate:modelValue":t[2]||(t[2]=e=>r.endTime=e),required:""},null,512),[[o.Jo,r.endTime]])]),(0,i.Lk)("div",null,[t[8]||(t[8]=(0,i.Lk)("label",{for:"description"},"Description:",-1)),(0,i.bo)((0,i.Lk)("textarea",{id:"description","onUpdate:modelValue":t[3]||(t[3]=e=>r.description=e)},null,512),[[o.Jo,r.description]])]),t[9]||(t[9]=(0,i.Lk)("button",{type:"submit"},"Create Appointment",-1))],32)):(0,i.Q3)("",!0),n.isAuthenticated?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("p",p,"Please log in to create an appointment.")),r.message?((0,i.uX)(),(0,i.CE)("p",d,(0,a.v_)(r.message),1)):(0,i.Q3)("",!0)])}var m=n(4373),v={props:{isAuthenticated:{type:Boolean,required:!0}},setup(e){const t=(0,s.KR)(""),n=(0,s.KR)(""),o=(0,s.KR)(""),i=(0,s.KR)(""),a=(0,s.KR)(""),r=async()=>{if(e.isAuthenticated)try{const e=localStorage.getItem("accessToken");if(!e)return void(a.value="Access token is missing. Please log in again.");const r=await m.A.post("https://outlook-scheduler-poc-be-e4c1fcd1a068.herokuapp.com/appointments",{accessToken:e,title:t.value,startTime:n.value,endTime:o.value,description:i.value});201===r.status&&(a.value="Appointment created successfully!",t.value="",n.value="",o.value="",i.value="")}catch(r){console.error("Error creating appointment:",r),a.value="Failed to create appointment. Please try again."}else a.value="Please log in to create an appointment."};return{title:t,startTime:n,endTime:o,description:i,createAppointment:r,message:a}}},h=n(1241);const k=(0,h.A)(v,[["render",f],["__scopeId","data-v-482f45f0"]]);var g=k,b={components:{AppointmentForm:g},setup(){const e=(0,s.KR)(!1),t=(0,s.KR)(""),n=(0,s.KR)(""),o=()=>{window.location.href="https://outlook-scheduler-poc-be-e4c1fcd1a068.herokuapp.com/auth/login"},a=()=>{e.value=!1,t.value="",n.value="",localStorage.removeItem("accessToken"),alert("You have been logged out.")},r=()=>{const o=new URLSearchParams(window.location.search),i=o.get("accessToken"),a=o.get("userName");if(i)n.value=i,t.value=a||"User",e.value=!0,localStorage.setItem("accessToken",i),window.history.replaceState({},document.title,"/");else{const t=localStorage.getItem("accessToken");t&&(n.value=t,e.value=!0)}};return(0,i.sV)((()=>{r()})),{isAuthenticated:e,userName:t,login:o,logout:a}}};const y=(0,h.A)(b,[["render",c]]);var T=y,L=n(75);const A={auth:{clientId:"1c0e40a8-4c6d-458e-9ed6-2167e7f2f47e",authority:"https://login.microsoftonline.com/434eb67d-52fc-447c-8ebf-7aaeda62969f",redirectUri:"https://outlook-scheduler-poc-be-e4c1fcd1a068.herokuapp.com/auth/callback"},cache:{cacheLocation:"localStorage"}},w=new L.vq(A),S=(0,o.Ef)(T);S.provide("msalInstance",w),S.mount("#app")}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,o,i,a){if(!o){var r=1/0;for(s=0;s<e.length;s++){o=e[s][0],i=e[s][1],a=e[s][2];for(var l=!0,u=0;u<o.length;u++)(!1&a||r>=a)&&Object.keys(n.O).every((function(e){return n.O[e](o[u])}))?o.splice(u--,1):(l=!1,a<r&&(r=a));if(l){e.splice(s--,1);var c=i();void 0!==c&&(t=c)}}return t}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[o,i,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,a,r=o[0],l=o[1],u=o[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(i in l)n.o(l,i)&&(n.m[i]=l[i]);if(u)var s=u(n)}for(t&&t(o);c<r.length;c++)a=r[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(s)},o=self["webpackChunkoutlook_scheduler_poc"]=self["webpackChunkoutlook_scheduler_poc"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(7861)}));o=n.O(o)})();
//# sourceMappingURL=app.fdbfacca.js.map